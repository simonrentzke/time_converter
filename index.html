<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Time Converter</title>
    <link href="/stylesheets/normalise.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="javascripts/chosen/chosen.css">
    <script src="/javascripts/all.js" type="text/javascript"></script>
  </head>
  
  <body class="index">
    <div>
      <!-- <div class="pure-u-1-5"></div> -->
      <!-- <div class="pure-u-3-5"> -->
        <div class="welcome">
  <h1 class="page-title">Convert Your Time</h1>
  <p class="doc">
  	<label for="input_time">Enter time</label>
    <input id="input_time" class="time-input" name="input_time" type="text" />
    <button type="submit" value="Convert" id="convert">Convert</button>
    
  </p>
  <p class="or-select">Or <select id="input_timezone" class="input-timezone" name="timezone"></select>
  </p>
  <div class="answers">
  	<p class="hidden" id="that_is">That is</p>
  	<ul>
  		<li id='time_utc'></li>
  		<li id='time_local'></li>
  		<li id='time_zone'></li>
  	</ul>
  </div>
</div>

<script type="text/javascript">
	var ft = 'YYYY-MM-DD H:mm:ss Z'
	$('#input_time').keydown(function(e) {
		convertTime();
	})
	
	$('#convert').click(function(e) {
		convertTime();
	})
 	var keys = Object.keys(momentTzData.zones)
	var options = keys.map(function(zone) {
		return '<option value="' + zone + '"">' + zone + '</option>'
	})

	$('#input_timezone').html('<option value="">Choose timezone...</option>' + options.join())
	$('#input_time').val(moment().format(ft))

	$('#input_timezone').change(function() {convertTime()})
	$('#input_timezone').chosen();

	function convertTime() {
		var time = $('#input_time').val();
		var parsed = moment(time);
		if (parsed && parsed.isValid()) {
			$('#that_is').removeClass('hidden');
			$('#time_local').html('<strong>' + parsed.format(ft) + '</strong> locally for you.');
			$('#time_utc').html('<strong>' + parsed.utc().format(ft) + '</strong> in UTC.');
			var tzinfo = $('#input_timezone').val()
			console.log(tzinfo);
			if (tzinfo != '') {
				$('#time_zone').html('<strong>' + parsed.tz(tzinfo).format(ft) + '</strong> in ' + tzinfo + '.');
			}
		} else {
			$('#that_is').addClass('hidden');
		}
	}
</script>
      <!-- </div> -->
      <!-- <div class="pure-u-1-5"></div> -->
    <div>
  </body>
</html>